<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../../styles/admin/manage-categories.css" />

    <title>Manage Complaints</title>
  </head>
  <body class="en-Oxanium transition-05">
    <h1 class="m-2 text-center">Manage Complaints</h1>

    <div class="container-fluid">
      <form class="mx-auto text-center col-md-9" action="" method="">
        <a
          href="./all-complaints.html"
          class="btn btn-success m-2 float-end d-inline"
          >All Complaints</a
        >
        <h1 class="m-2 wd-fit d-inline">Create New Complaint</h1>
        <input
          class="col-10 col-md-12"
          type="text"
          name="name"
          placeholder="name"
          id="complaint-title"
          cols="10"
        /><br />

        <textarea
          name="description"
          class="col-10 col-md-12"
          id="complaint-description"
          placeholder="Description"
          cols="50"
          rows="10"
        ></textarea>

        <p class="text-start fw-500">
          <label for="complaint-category">Category</label>
          <select class="w-25 p-2" name="category" id="complaint-category">
            <option value="">Choose Category</option>
          </select>
        </p>
        <p class="text-start fw-500">
          <label for="complaint-department">Department</label>
          <select class="w-25 p-2" name="department" id="complaint-department">
            <option value="">Choose Department</option>
          </select>
        </p>

        <p class="text-start fw-500">
          <label for="complaint-private">Make Complaint Private</label>
          <input class="" type="checkbox" id="complaint-private" />
        </p>

        <br />
        <button
          class="btn btn-primary col-10 col-md-12"
          type="button"
          onclick="createComplaint(event)"
        >
          Create New Complaint
        </button>
      </form>

      <div class="col-12 px-3 w-fit bg-light">
        <h2 class="m-2 text-center sticky-top bg-light p-2">All Complaints</h2>
        <button class="btn btn-secondary" onclick="myComplaints()">
          My Complaints
        </button>
        <p id="total-complaints"></p>
        <div
          class="row d-flex flex-row justify-content-around align-items-center"
          id="complaints"
        >
          <script>
            document.addEventListener("DOMContentLoaded", () =>
              viewComplaints()
            );
          </script>
        </div>
      </div>
    </div>

    <!-- Script to fetch departments and categories -->
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        fetchCategories().then((categories) => {
          categories.forEach((category) => {
            document.getElementById(
              "complaint-category"
            ).innerHTML += ` <option value="${category.id}">${category.name}</option>
          `;
          });
        });

        fetchDepartments().then((departments) => {
          departments.forEach((department) => {
            document.getElementById(
              "complaint-department"
            ).innerHTML += ` <option value="${department.id}">${department.name}</option>
          `;
          });
        });
      });
    </script>

    <!-- Bootstrap Files -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
      crossorigin="anonymous"
    ></script>

    <!-- Load Intense css  -->
    <link rel="stylesheet" href="../../styles/defaults.css" />

    <!-- JavaScript Universal lient Scripts Importer -->
    <script
      src="../../client-scripts/modules/importer.js"
      type="module"
    ></script>

    <script>
      window.addEventListener("DOMContentLoaded", () => {
        setTimeout(() => window.user.checkAdmin(), 100);
      });
    </script>
  </body>
</html>
